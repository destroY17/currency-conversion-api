## Проект "Обмен валют"

REST API для описания валют и обменных курсов. Позволяет просматривать и редактировать списки валют и обменных курсов, и совершать расчёт конвертации произвольных сумм из одной валюты в другую.
Веб-интерфейс для проекта не подразумевается.

## Стэк технологий
- Java SE 17
- Spring Framework (без Spring Boot)
- Maven
- JDBC
- PostgreSQL
- Postman

## Мотивация проекта

- REST API - правильное именование ресурсов, использование HTTP кодов ответа
- Практика использования Spring Framework, SQL

## Структура базы данных

### `currencies`

| Колонка | Тип | Комментарий |
| --- | --- | --- |
| id | int | Айди валюты, автоинкремент, первичный ключ |
| code | Varchar | Код валюты |
| full_name | Varchar | Полное имя валюты |
| sign | Varchar | Символ валюты |

Пример записи в таблице для австралийского доллара:
| id | code | full_name | sign |
| --- | --- | --- | --- |
| 1 | AUD | Australian dollar | A$ |

Коды валют мира - https://www.iban.com/currency-codes.

Индексы:
- Первичный ключ по полю id
- Unique индекс по полю code для гарантий уникальности валюты в таблице, и для ускорения поиска валюты по её аббривеатуре

### `exchange_rates`

| Колонка | Тип | Комментарий |
| --- | --- | --- |
| id | int | Айди курса обмена, автоинкремент, первичный ключ |
| base_currency_id | int | ID базовой валюты|
| target_currency_id | int | ID целевой валюты |
| rate | Decimal(6) | Курс обмена единицы базовой валюты к единице целевой валюты |

`Decimal(6)` - десятичное число с 6 знаками после запятой. Полезно для валют, отличающихся на порядки. Например, одна Японская иена равна 0.0073 USD.

Индексы:
- Первичный ключ по полю ID
- Unique индекс по паре полей base_currency_id, target_currency_id для гарантий уникальности валютной пары, и для ускорения поиска курса по паре валют
  
## REST API

Методы REST API реализуют [CRUD](https://en.wikipedia.org/wiki/Create,_read,_update_and_delete) интерфейс над базой данных - позволяют создавать (C - craete), читать (R - read), редактировать (U - update) и удалять (D - delete).

### Валюты

#### GET `/currencies`

Получение списка валют. Пример ответа:
```
[
    {
        "id": 1,
        "code": "USD",
        "name": "US Dollar",
        "sign": "$"
    },
    {
        "id": 2,
        "code": "EUR",
        "name": "Euro",
        "sign": "€"
    }
]
```

HTTP коды ответов:
- Успех - 200
- Ошибка (например, база данных недоступна) - 500

#### GET `/currency/USD`

Получение конкретной валюты. Пример ответа:
```
{
    "id": 0,
    "name": "Euro",
    "code": "EUR",
    "sign": "€"
}
```

HTTP коды ответов:
- Успех - 200
- Невалидный код валюты в адресе - 400
- Валюта не найдена - 404
- Ошибка (например, база данных недоступна) - 500

#### POST `/currencies`

Добавление новой валюты в базу. Данные передаются в теле запроса в JSON формате со следующими ключами: `name`, `code`, `sign`.
Например:
```
{
    "name":"Swedish Krona",
    "code":"SEK",
    "sign":"kr"
}
```

Пример ответа - JSON представление вставленной в базу записи, включая её ID:
```
{
    "id": 7,
    "code": "SEK",
    "name": "Swedish Krona",
    "sign": "kr"
}
```

HTTP коды ответов:
- Успех - 200
- Отсутствует необходимые данные в теле запроса/невалидные данные - 400
- Валюта с таким кодом уже существует - 409
- Ошибка (например, база данных недоступна) - 500

### Обменные курсы

#### GET `/exchangeRates`

Получение списка всех обменных курсов. Пример ответа:
```
[
    "id": 1,
        "baseCurrency": {
            "id": 1,
            "code": "USD",
            "name": "US Dollar",
            "sign": "$"
        },
        "targetCurrency": {
            "id": 2,
            "code": "EUR",
            "name": "Euro",
            "sign": "€"
        },
        "rate": 0.94
]
```

HTTP коды ответов:
- Успех - 200
- Ошибка (например, база данных недоступна) - 500

#### GET `/exchangeRate/USD/EUR`

Получение конкретного обменного курса. Валютная пара задаётся идущими подряд, разделенными `/`, кодами валют в адресе запроса. Пример ответа:
```
{
    "id": 0,
    "baseCurrency": {
        "id": 0,
        "name": "United States dollar",
        "code": "USD",
        "sign": "$"
    },
    "targetCurrency": {
        "id": 1,
        "name": "Euro",
        "code": "EUR",
        "sign": "€"
    },
    "rate": 0.94
}

```

HTTP коды ответов:
- Успех - 200
- Невалидные коды валют в адресе - 400
- Обменный курс для пары не найден - 404
- Ошибка (например, база данных недоступна) - 500

#### POST `/exchangeRates`

Добавление нового обменного курса в базу. Данные передаются в теле запроса в JSON формате со следующими ключами: `baseCurrencyCode`, `targetCurrencyCode`, `rate`. 
Например:
```
{
    "baseCurrencyCode" : "USD",
    "targetCurrencyCode" : "EUR",
    "rate" : 0.94
}
```

Пример ответа - JSON представление вставленной в базу записи, включая её ID:
```
{
    "id": 0,
    "baseCurrency": {
        "id": 0,
        "name": "United States dollar",
        "code": "USD",
        "sign": "$"
    },
    "targetCurrency": {
        "id": 1,
        "name": "Euro",
        "code": "EUR",
        "sign": "€"
    },
    "rate": 0.94
}
```

HTTP коды ответов:
- Успех - 200
- Отсутствует необходимые данные в теле запроса/невалидные данные - 400
- Валютная пара с таким кодом уже существует - 409
- Ошибка (например, база данных недоступна) - 500

#### PATCH `/exchangeRate/USDRUB`

Обновление существующего в базе обменного курса. Валютная пара задаётся идущими подряд, разделенными `/`, кодами валют в адресе запроса. Данные передаются в теле запроса в JSON формате с единственным ключом - `rate`.
Например:
```
{
    "rate": 0.91
}
```

Пример ответа - JSON представление обновлённой записи в базе данных, включая её ID:
```
{
    "id": 0,
    "baseCurrency": {
        "id": 0,
        "name": "United States dollar",
        "code": "USD",
        "sign": "$"
    },
    "targetCurrency": {
        "id": 1,
        "name": "Euro",
        "code": "EUR",
        "sign": "€"
    },
    "rate": 0.94
}
```

HTTP коды ответов:
- Успех - 200
- Отсутствует необходимые данные в теле запроса/невалидные данные - 400
- Валютная пара отсутствует в базе данных - 404
- Ошибка (например, база данных недоступна) - 500

### Обмен валюты

#### GET `/exchange?from=BASE_CURRENCY_CODE&to=TARGET_CURRENCY_CODE&amount=$AMOUNT`

Расчёт перевода определённого количества средств из одной валюты в другую. Пример запроса - GET `/exchange?from=USD&to=EUR&amount=10`.

Пример ответа:
```
{
    "id": 0,
    "baseCurrency": {
        "id": 0,
        "name": "United States dollar",
        "code": "USD",
        "sign": "$"
    },
    "targetCurrency": {
        "id": 1,
        "name": "Australian dollar",
        "code": "AUD",
        "sign": "A€"
    },
    "rate": 1.45,
    "amount": 10.00
    "convertedAmount": 14.50
}
```

Получение курса для обмена может пройти по одному из трёх сценариев. Допустим, совершаем перевод из валюты **A** в валюту **B**:
1. В таблице `ExchangeRates` существует валютная пара **AB** - берём её курс
2. В таблице `ExchangeRates` существует валютная пара **BA** - берем её курс, и считаем обратный, чтобы получить **AB**
3. В таблице `ExchangeRates` существуют валютные пары **USD-A** и **USD-B** - вычисляем из этих курсов курс **AB**

Остальные возможные сценарии опущены.

---
